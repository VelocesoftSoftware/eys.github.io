{"ast":null,"code":"import{useState,useEffect,useRef}from\"react\";import{Marker,MapContainer,TileLayer,Popup}from\"react-leaflet\";import L from\"leaflet\";import tileLayer from\"../util/tileLayer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const center=[52.22977,21.01178];const Legend=_ref=>{let{map}=_ref;const[view,setView]=useState(true);const markerRef=useRef(null);useEffect(()=>{if(!map)return;const legend=L.control({position:\"bottomleft\"});legend.onAdd=()=>{legend.div=L.DomUtil.create(\"div\",\"description\");L.DomEvent.disableClickPropagation(legend.div);legend.div.innerHTML=\"We check if the marker is in the page view. Move the marker so that it is outside the map. Marker in view: <b style=\\\"color: \".concat(view?\"black\":\"red\",\"\\\">\").concat(view,\"</b>\");return legend.div;};legend.addTo(map);const checkIfMarkerIsInViewport=()=>{const mapBounds=map.getBounds();const contains=mapBounds.contains(markerRef.current.getLatLng());setView(contains);};map.on(\"moveend\",checkIfMarkerIsInViewport);// remove the legend\nreturn()=>{legend.remove();map.off(\"moveend\",checkIfMarkerIsInViewport);};},[map,view]);return/*#__PURE__*/_jsx(Marker,{ref:markerRef,position:center,children:/*#__PURE__*/_jsx(Popup,{children:\"Center Warsaw\"})});};const MapWrapper=()=>{const[map,setMap]=useState(null);return/*#__PURE__*/_jsxs(MapContainer,{whenCreated:setMap,center:center,zoom:18,scrollWheelZoom:false,children:[/*#__PURE__*/_jsx(TileLayer,{...tileLayer}),/*#__PURE__*/_jsx(Legend,{map:map})]});};export default MapWrapper;","map":{"version":3,"names":["useState","useEffect","useRef","Marker","MapContainer","TileLayer","Popup","L","tileLayer","jsx","_jsx","jsxs","_jsxs","center","Legend","_ref","map","view","setView","markerRef","legend","control","position","onAdd","div","DomUtil","create","DomEvent","disableClickPropagation","innerHTML","concat","addTo","checkIfMarkerIsInViewport","mapBounds","getBounds","contains","current","getLatLng","on","remove","off","ref","children","MapWrapper","setMap","whenCreated","zoom","scrollWheelZoom"],"sources":["/Users/berkanium/Desktop/eys-react-leaflet/src/pages/checking-if-the-marker-is-in-viewport.js"],"sourcesContent":["import { useState, useEffect, useRef } from \"react\";\nimport { Marker, MapContainer, TileLayer, Popup } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport tileLayer from \"../util/tileLayer\";\n\nconst center = [52.22977, 21.01178];\n\nconst Legend = ({ map }) => {\n  const [view, setView] = useState(true);\n  const markerRef = useRef(null);\n\n  useEffect(() => {\n    if (!map) return;\n\n    const legend = L.control({ position: \"bottomleft\" });\n\n    legend.onAdd = () => {\n      legend.div = L.DomUtil.create(\"div\", \"description\");\n\n      L.DomEvent.disableClickPropagation(legend.div);\n\n      legend.div.innerHTML = `We check if the marker is in the page view. Move the marker so that it is outside the map. Marker in view: <b style=\"color: ${\n        view ? \"black\" : \"red\"\n      }\">${view}</b>`;\n\n      return legend.div;\n    };\n\n    legend.addTo(map);\n\n    const checkIfMarkerIsInViewport = () => {\n      const mapBounds = map.getBounds();\n      const contains = mapBounds.contains(markerRef.current.getLatLng());\n      setView(contains);\n    };\n\n    map.on(\"moveend\", checkIfMarkerIsInViewport);\n\n    // remove the legend\n    return () => {\n      legend.remove();\n      map.off(\"moveend\", checkIfMarkerIsInViewport);\n    };\n  }, [map, view]);\n\n  return (\n    <Marker ref={markerRef} position={center}>\n      <Popup>Center Warsaw</Popup>\n    </Marker>\n  );\n};\n\nconst MapWrapper = () => {\n  const [map, setMap] = useState(null);\n  return (\n    <MapContainer\n      whenCreated={setMap}\n      center={center}\n      zoom={18}\n      scrollWheelZoom={false}\n    >\n      <TileLayer {...tileLayer} />\n\n      <Legend map={map} />\n    </MapContainer>\n  );\n};\n\nexport default MapWrapper;\n"],"mappings":"AAAA,OAASA,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CACnD,OAASC,MAAM,CAAEC,YAAY,CAAEC,SAAS,CAAEC,KAAK,KAAQ,eAAe,CACtE,MAAO,CAAAC,CAAC,KAAM,SAAS,CACvB,MAAO,CAAAC,SAAS,KAAM,mBAAmB,CAAC,OAAAC,GAAA,IAAAC,IAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAE1C,KAAM,CAAAC,MAAM,CAAG,CAAC,QAAQ,CAAE,QAAQ,CAAC,CAEnC,KAAM,CAAAC,MAAM,CAAGC,IAAA,EAAa,IAAZ,CAAEC,GAAI,CAAC,CAAAD,IAAA,CACrB,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGlB,QAAQ,CAAC,IAAI,CAAC,CACtC,KAAM,CAAAmB,SAAS,CAAGjB,MAAM,CAAC,IAAI,CAAC,CAE9BD,SAAS,CAAC,IAAM,CACd,GAAI,CAACe,GAAG,CAAE,OAEV,KAAM,CAAAI,MAAM,CAAGb,CAAC,CAACc,OAAO,CAAC,CAAEC,QAAQ,CAAE,YAAa,CAAC,CAAC,CAEpDF,MAAM,CAACG,KAAK,CAAG,IAAM,CACnBH,MAAM,CAACI,GAAG,CAAGjB,CAAC,CAACkB,OAAO,CAACC,MAAM,CAAC,KAAK,CAAE,aAAa,CAAC,CAEnDnB,CAAC,CAACoB,QAAQ,CAACC,uBAAuB,CAACR,MAAM,CAACI,GAAG,CAAC,CAE9CJ,MAAM,CAACI,GAAG,CAACK,SAAS,iIAAAC,MAAA,CAClBb,IAAI,CAAG,OAAO,CAAG,KAAK,QAAAa,MAAA,CACnBb,IAAI,QAAM,CAEf,MAAO,CAAAG,MAAM,CAACI,GAAG,CACnB,CAAC,CAEDJ,MAAM,CAACW,KAAK,CAACf,GAAG,CAAC,CAEjB,KAAM,CAAAgB,yBAAyB,CAAGA,CAAA,GAAM,CACtC,KAAM,CAAAC,SAAS,CAAGjB,GAAG,CAACkB,SAAS,CAAC,CAAC,CACjC,KAAM,CAAAC,QAAQ,CAAGF,SAAS,CAACE,QAAQ,CAAChB,SAAS,CAACiB,OAAO,CAACC,SAAS,CAAC,CAAC,CAAC,CAClEnB,OAAO,CAACiB,QAAQ,CAAC,CACnB,CAAC,CAEDnB,GAAG,CAACsB,EAAE,CAAC,SAAS,CAAEN,yBAAyB,CAAC,CAE5C;AACA,MAAO,IAAM,CACXZ,MAAM,CAACmB,MAAM,CAAC,CAAC,CACfvB,GAAG,CAACwB,GAAG,CAAC,SAAS,CAAER,yBAAyB,CAAC,CAC/C,CAAC,CACH,CAAC,CAAE,CAAChB,GAAG,CAAEC,IAAI,CAAC,CAAC,CAEf,mBACEP,IAAA,CAACP,MAAM,EAACsC,GAAG,CAAEtB,SAAU,CAACG,QAAQ,CAAET,MAAO,CAAA6B,QAAA,cACvChC,IAAA,CAACJ,KAAK,EAAAoC,QAAA,CAAC,eAAa,CAAO,CAAC,CACtB,CAAC,CAEb,CAAC,CAED,KAAM,CAAAC,UAAU,CAAGA,CAAA,GAAM,CACvB,KAAM,CAAC3B,GAAG,CAAE4B,MAAM,CAAC,CAAG5C,QAAQ,CAAC,IAAI,CAAC,CACpC,mBACEY,KAAA,CAACR,YAAY,EACXyC,WAAW,CAAED,MAAO,CACpB/B,MAAM,CAAEA,MAAO,CACfiC,IAAI,CAAE,EAAG,CACTC,eAAe,CAAE,KAAM,CAAAL,QAAA,eAEvBhC,IAAA,CAACL,SAAS,KAAKG,SAAS,CAAG,CAAC,cAE5BE,IAAA,CAACI,MAAM,EAACE,GAAG,CAAEA,GAAI,CAAE,CAAC,EACR,CAAC,CAEnB,CAAC,CAED,cAAe,CAAA2B,UAAU"},"metadata":{},"sourceType":"module"}