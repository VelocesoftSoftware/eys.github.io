{"ast":null,"code":"import{useState,useEffect}from\"react\";import{MapContainer,TileLayer,useMap}from\"react-leaflet\";import styles from\"./location-button.module.css\";import L from\"leaflet\";import tileLayer from\"../util/tileLayer\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const center=[52.22977,21.01178];const LocationButton=()=>{const map=useMap();useEffect(()=>{// create custom button\nconst customControl=L.Control.extend({// button position\noptions:{position:\"topleft\",className:\"\".concat(styles.locateButton,\" leaflet-bar\"),html:'<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\"/></svg>',style:\"width: 34px; height: 34px; left: 0; margin-top: 0; display: flex; cursor: pointer; justify-content: center; font-size: 2rem;\"},// method\nonAdd:function(map){this._map=map;const button=L.DomUtil.create(\"div\");L.DomEvent.disableClickPropagation(button);button.title=\"locate\";button.innerHTML=this.options.html;button.className=this.options.className;button.setAttribute(\"style\",this.options.style);L.DomEvent.on(button,\"click\",this._clicked,this);return button;},_clicked:function(e){L.DomEvent.stopPropagation(e);// this.removeLocate();\nthis._checkLocate();return;},_checkLocate:function(){return this._locateMap();},_locateMap:function(){const locateActive=document.querySelector(\".\".concat(styles.locateButton));const locate=locateActive.classList.contains(styles.locateActive);// add/remove class from locate button\nlocateActive.classList[locate?\"remove\":\"add\"](styles.locateActive);// remove class from button\n// and stop watching location\nif(locate){this.removeLocate();this._map.stopLocate();return;}// location on found\nthis._map.on(\"locationfound\",this.onLocationFound,this);// locataion on error\nthis._map.on(\"locationerror\",this.onLocationError,this);// start locate\nthis._map.locate({setView:true,enableHighAccuracy:true});},onLocationFound:function(e){// add circle\nthis.addCircle(e).addTo(this.featureGroup()).addTo(map);// add marker\nthis.addMarker(e).addTo(this.featureGroup()).addTo(map);// add legend\n},// on location error\nonLocationError:function(e){this.addLegend(\"Location access denied.\");},// feature group\nfeatureGroup:function(){return new L.FeatureGroup();},// add legend\naddLegend:function(text){const checkIfDescriotnExist=document.querySelector(\".description\");if(checkIfDescriotnExist){checkIfDescriotnExist.textContent=text;return;}const legend=L.control({position:\"bottomleft\"});legend.onAdd=function(){let div=L.DomUtil.create(\"div\",\"description\");L.DomEvent.disableClickPropagation(div);const textInfo=text;div.insertAdjacentHTML(\"beforeend\",textInfo);return div;};legend.addTo(this._map);},addCircle:function(_ref){let{accuracy,latitude,longitude}=_ref;return L.circle([latitude,longitude],accuracy/2,{className:\"circle-test\",weight:2,stroke:false,fillColor:\"#136aec\",fillOpacity:0.15});},addMarker:function(_ref2){let{latitude,longitude}=_ref2;return L.marker([latitude,longitude],{icon:L.divIcon({className:styles.locatedAnimation,iconSize:L.point(17,17),popupAnchor:[0,-15]})}).bindPopup(\"Your are here :)\");},removeLocate:function(){this._map.eachLayer(function(layer){if(layer instanceof L.Marker){const{icon}=layer.options;if((icon===null||icon===void 0?void 0:icon.options.className)===styles.locatedAnimation){map.removeLayer(layer);}}if(layer instanceof L.Circle){if(layer.options.className===\"circle-test\"){map.removeLayer(layer);}}});}});// adding new button to map controll\nmap.addControl(new customControl());},[map]);return null;};const MapWrapper=()=>{const[map,setMap]=useState(null);return/*#__PURE__*/_jsxs(MapContainer,{whenCreated:setMap,center:center,zoom:18,scrollWheelZoom:false,children:[/*#__PURE__*/_jsx(TileLayer,{...tileLayer}),/*#__PURE__*/_jsx(LocationButton,{map:map})]});};export default MapWrapper;","map":{"version":3,"names":["useState","useEffect","MapContainer","TileLayer","useMap","styles","L","tileLayer","jsx","_jsx","jsxs","_jsxs","center","LocationButton","map","customControl","Control","extend","options","position","className","concat","locateButton","html","style","onAdd","_map","button","DomUtil","create","DomEvent","disableClickPropagation","title","innerHTML","setAttribute","on","_clicked","e","stopPropagation","_checkLocate","_locateMap","locateActive","document","querySelector","locate","classList","contains","removeLocate","stopLocate","onLocationFound","onLocationError","setView","enableHighAccuracy","addCircle","addTo","featureGroup","addMarker","addLegend","FeatureGroup","text","checkIfDescriotnExist","textContent","legend","control","div","textInfo","insertAdjacentHTML","_ref","accuracy","latitude","longitude","circle","weight","stroke","fillColor","fillOpacity","_ref2","marker","icon","divIcon","locatedAnimation","iconSize","point","popupAnchor","bindPopup","eachLayer","layer","Marker","removeLayer","Circle","addControl","MapWrapper","setMap","whenCreated","zoom","scrollWheelZoom","children"],"sources":["/Users/berkanium/Desktop/eys-react-leaflet/src/pages/location-button.js"],"sourcesContent":["import { useState, useEffect } from \"react\";\nimport { MapContainer, TileLayer, useMap } from \"react-leaflet\";\nimport styles from \"./location-button.module.css\";\nimport L from \"leaflet\";\nimport tileLayer from \"../util/tileLayer\";\n\nconst center = [52.22977, 21.01178];\n\nconst LocationButton = () => {\n  const map = useMap();\n\n  useEffect(() => {\n    // create custom button\n    const customControl = L.Control.extend({\n      // button position\n      options: {\n        position: \"topleft\",\n        className: `${styles.locateButton} leaflet-bar`,\n        html: '<svg viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3A8.994 8.994 0 0 0 13 3.06V1h-2v2.06A8.994 8.994 0 0 0 3.06 11H1v2h2.06A8.994 8.994 0 0 0 11 20.94V23h2v-2.06A8.994 8.994 0 0 0 20.94 13H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\"/></svg>',\n        style:\n          \"width: 34px; height: 34px; left: 0; margin-top: 0; display: flex; cursor: pointer; justify-content: center; font-size: 2rem;\",\n      },\n\n      // method\n      onAdd: function (map) {\n        this._map = map;\n        const button = L.DomUtil.create(\"div\");\n        L.DomEvent.disableClickPropagation(button);\n\n        button.title = \"locate\";\n        button.innerHTML = this.options.html;\n        button.className = this.options.className;\n        button.setAttribute(\"style\", this.options.style);\n\n        L.DomEvent.on(button, \"click\", this._clicked, this);\n\n        return button;\n      },\n      _clicked: function (e) {\n        L.DomEvent.stopPropagation(e);\n\n        // this.removeLocate();\n\n        this._checkLocate();\n\n        return;\n      },\n      _checkLocate: function () {\n        return this._locateMap();\n      },\n\n      _locateMap: function () {\n        const locateActive = document.querySelector(`.${styles.locateButton}`);\n        const locate = locateActive.classList.contains(styles.locateActive);\n        // add/remove class from locate button\n        locateActive.classList[locate ? \"remove\" : \"add\"](styles.locateActive);\n\n        // remove class from button\n        // and stop watching location\n        if (locate) {\n          this.removeLocate();\n          this._map.stopLocate();\n          return;\n        }\n\n        // location on found\n        this._map.on(\"locationfound\", this.onLocationFound, this);\n        // locataion on error\n        this._map.on(\"locationerror\", this.onLocationError, this);\n\n        // start locate\n        this._map.locate({ setView: true, enableHighAccuracy: true });\n      },\n      onLocationFound: function (e) {\n        // add circle\n        this.addCircle(e).addTo(this.featureGroup()).addTo(map);\n\n        // add marker\n        this.addMarker(e).addTo(this.featureGroup()).addTo(map);\n\n        // add legend\n      },\n      // on location error\n      onLocationError: function (e) {\n        this.addLegend(\"Location access denied.\");\n      },\n      // feature group\n      featureGroup: function () {\n        return new L.FeatureGroup();\n      },\n      // add legend\n      addLegend: function (text) {\n        const checkIfDescriotnExist = document.querySelector(\".description\");\n\n        if (checkIfDescriotnExist) {\n          checkIfDescriotnExist.textContent = text;\n          return;\n        }\n\n        const legend = L.control({ position: \"bottomleft\" });\n\n        legend.onAdd = function () {\n          let div = L.DomUtil.create(\"div\", \"description\");\n          L.DomEvent.disableClickPropagation(div);\n          const textInfo = text;\n          div.insertAdjacentHTML(\"beforeend\", textInfo);\n          return div;\n        };\n        legend.addTo(this._map);\n      },\n      addCircle: function ({ accuracy, latitude, longitude }) {\n        return L.circle([latitude, longitude], accuracy / 2, {\n          className: \"circle-test\",\n          weight: 2,\n          stroke: false,\n          fillColor: \"#136aec\",\n          fillOpacity: 0.15,\n        });\n      },\n      addMarker: function ({ latitude, longitude }) {\n        return L.marker([latitude, longitude], {\n          icon: L.divIcon({\n            className: styles.locatedAnimation,\n            iconSize: L.point(17, 17),\n            popupAnchor: [0, -15],\n          }),\n        }).bindPopup(\"Your are here :)\");\n      },\n      removeLocate: function () {\n        this._map.eachLayer(function (layer) {\n          if (layer instanceof L.Marker) {\n            const { icon } = layer.options;\n            if (icon?.options.className === styles.locatedAnimation) {\n              map.removeLayer(layer);\n            }\n          }\n          if (layer instanceof L.Circle) {\n            if (layer.options.className === \"circle-test\") {\n              map.removeLayer(layer);\n            }\n          }\n        });\n      },\n    });\n\n    // adding new button to map controll\n    map.addControl(new customControl());\n  }, [map]);\n\n  return null;\n};\n\nconst MapWrapper = () => {\n  const [map, setMap] = useState(null);\n  return (\n    <MapContainer\n      whenCreated={setMap}\n      center={center}\n      zoom={18}\n      scrollWheelZoom={false}\n    >\n      <TileLayer {...tileLayer} />\n\n      <LocationButton map={map} />\n    </MapContainer>\n  );\n};\n\nexport default MapWrapper;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}